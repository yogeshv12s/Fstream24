<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Video Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<style>
  html, body { margin:0; padding:0; height:100%; width:100%; background:#000; font-family: Arial, sans-serif; color:white; }
  body { display:flex; flex-direction:column; }

  /* Video container */
  #video-container { position: relative; width:100%; background:black; display:flex; justify-content:center; align-items:center; }
  #stream-media { width:100%; max-height:60vh; background:black; }

  /* Big Play Button */
  #big-play { position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); font-size:70px; color:white; background:rgba(0,0,0,0.5); border-radius:50%; padding:20px; cursor:pointer; z-index:10; transition:0.3s; }
  #big-play:hover { background:rgba(255,255,255,0.7); color:black; }

  /* Control Bar */
  #control-bar { position: absolute; bottom:0; left:0; right:0; background:rgba(0,0,0,0.7); display:flex; align-items:center; padding:10px; z-index:10; flex-wrap:wrap; }
  #control-bar i { font-size:20px; margin-right:10px; cursor:pointer; }
  #progress-container { flex:1; height:5px; background: rgba(255,255,255,0.3); border-radius:3px; margin:0 10px; position:relative; cursor:pointer; }
  #progress { height:5px; background:#e50914; width:0%; border-radius:3px; }
  #time-display { font-size:14px; white-space:nowrap; }

  /* Top buttons */
  .custom-button { position:absolute; width:40px; height:40px; border-radius:50%; display:flex; justify-content:center; align-items:center; background:rgba(0,0,0,0.7); color:white; cursor:pointer; transition:0.3s; }
  .custom-button:hover { background:rgba(255,255,255,0.7); color:black; }

  /* Watermark */
  .mejs-watermark { position:absolute; top:10px; right:10px; width:80px; opacity:0.6; pointer-events:none; }

  /* Comments section */
  #comments { flex:1; padding:20px; background:#111; overflow-y:auto; }
  #comments h3 { margin-bottom:10px; }
  .comment { margin-bottom:15px; padding:10px; background:#222; border-radius:8px; }
  .comment .user { font-weight:bold; margin-bottom:5px; }

  /* Download button */
  #download-btn { display:inline-block; background:#e50914; color:white; padding:10px 20px; border-radius:6px; text-decoration:none; margin-top:10px; cursor:pointer; }

  /* Responsive */
  @media(max-width:768px){
    #stream-media { max-height:40vh; }
    #big-play { font-size:50px; padding:15px; }
    .custom-button { width:35px; height:35px; font-size:16px; }
    #control-bar i { font-size:16px; margin-right:5px; }
  }
</style>
</head>
<body>

<div id="video-container">
  <video id="stream-media" preload="auto"></video>
  <div id="big-play"><i class="fas fa-play"></i></div>
  <div id="control-bar">
    <i id="bottom-play" class="fas fa-play"></i>
    <div id="progress-container"><div id="progress"></div></div>
    <span id="time-display">00:00 / 00:00</span>
  </div>
  <img src="https://chadstreamz.sbs/assets/images/log2.png" class="mejs-watermark">
  <div class="custom-button" id="top-play" style="top:10px; left:10px;"><i class="fas fa-play"></i></div>
  <div class="custom-button" id="volume-btn" style="top:60px; left:10px;"><i class="fas fa-volume-up"></i></div>
  <div class="custom-button" id="fullscreen-btn" style="top:110px; left:10px;"><i class="fas fa-expand"></i></div>
</div>

<div id="comments">
  <h3>Comments</h3>
  <div class="comment"><div class="user">User1:</div> Amazing video!</div>
  <div class="comment"><div class="user">User2:</div> Loved this content, keep it up!</div>
  <div class="comment"><div class="user">User3:</div> Can I download this?</div>
  <a id="download-btn">Download Video</a>
</div>

<script>
var mediaLink = "{{ mediaLink }}"; // Replace with your media URL
var video = document.getElementById('stream-media');
var bigPlay = document.getElementById('big-play');
var bottomPlay = document.getElementById('bottom-play');
var topPlayBtn = document.getElementById('top-play');
var volumeBtn = document.getElementById('volume-btn');
var fullscreenBtn = document.getElementById('fullscreen-btn');
var progress = document.getElementById('progress');
var progressContainer = document.getElementById('progress-container');
var timeDisplay = document.getElementById('time-display');
var downloadBtn = document.getElementById('download-btn');

if(!mediaLink){ alert("Media URL not provided"); }

video.src = mediaLink;

// Play/Pause Logic
function togglePlay() {
  if(video.paused){ video.play(); bottomPlay.className='fas fa-pause'; topPlayBtn.innerHTML='<i class="fas fa-pause"></i>'; bigPlay.style.display='none'; }
  else { video.pause(); bottomPlay.className='fas fa-play'; topPlayBtn.innerHTML='<i class="fas fa-play"></i>'; bigPlay.style.display='block'; }
}

bigPlay.onclick = togglePlay;
bottomPlay.onclick = togglePlay;
topPlayBtn.onclick = togglePlay;

// Volume
volumeBtn.onclick = function(){
  if(video.muted){ video.muted=false; volumeBtn.innerHTML='<i class="fas fa-volume-up"></i>'; }
  else { video.muted=true; volumeBtn.innerHTML='<i class="fas fa-volume-mute"></i>'; }
};

// Fullscreen
fullscreenBtn.onclick = function(){
  if(!document.fullscreenElement){ video.requestFullscreen(); fullscreenBtn.innerHTML='<i class="fas fa-compress"></i>'; }
  else { document.exitFullscreen(); fullscreenBtn.innerHTML='<i class="fas fa-expand"></i>'; }
};

// Progress Bar
let isDragging = false;
function updateProgress(e){
  const rect = progressContainer.getBoundingClientRect();
  const x = e.clientX ?? e.touches[0].clientX;
  let pos = Math.min(Math.max(0, x - rect.left), rect.width)/rect.width;
  video.currentTime = pos*video.duration;
}
progressContainer.addEventListener('pointerdown', (e)=>{ isDragging=true; updateProgress(e); video.pause(); progressContainer.setPointerCapture(e.pointerId); });
progressContainer.addEventListener('pointermove', (e)=>{ if(isDragging) updateProgress(e); });
progressContainer.addEventListener('pointerup', (e)=>{ if(isDragging){ updateProgress(e); isDragging=false; video.play(); }});
video.addEventListener('timeupdate', ()=>{ if(!isDragging){ progress.style.width = (video.currentTime/video.duration)*100 + '%'; } 
  const m=Math.floor(video.currentTime/60).toString().padStart(2,'0');
  const s=Math.floor(video.currentTime%60).toString().padStart(2,'0');
  const dm=Math.floor(video.duration/60).toString().padStart(2,'0');
  const ds=Math.floor(video.duration%60).toString().padStart(2,'0');
  timeDisplay.textContent = m+":"+s+" / "+dm+":"+ds;
});

// Download Logic
downloadBtn.onclick = function(){
  const a = document.createElement('a');
  a.href = mediaLink;
  a.download='';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
};
</script>

</body>
</html>
