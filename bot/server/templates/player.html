<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Play Files</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/5.0.5/mediaelementplayer.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/5.0.5/mediaelement-and-player.min.js"></script>

<style>
html, body { margin:0; height:100%; background:black; }
#stream-media { width:100%; height:100%; }

.mejs-watermark {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 80px;
  opacity: 0.6;
  z-index: 1000;
  pointer-events: none;
}

/* Custom top buttons */
.custom-button {
  position: absolute;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  text-align: center;
  line-height: 40px;
  color: white;
  background-color: rgba(0,0,0,0.7);
  z-index: 1000;
  cursor: pointer;
  font-family: "Font Awesome 5 Free";
  font-weight: 900;
  font-size: 18px;
  transition: 0.3s;
}
.custom-button:hover { background-color: rgba(255,255,255,0.7); color:black; }

/* Responsive */
@media(max-width:768px){
  .mejs-watermark { width: 60px; }
  .custom-button { width: 30px; height: 30px; line-height:30px; font-size:14px; }
}
@media(min-width:1200px){
  .mejs-watermark { width: 100px; }
  .custom-button { width: 45px; height: 45px; line-height:45px; font-size:20px; }
}
</style>
</head>
<body>

<video id="stream-media" preload="auto" controls></video>
<div id="error-message"></div>

<script>
var mediaLink = "{{ mediaLink }}"; // replace with your media URL

if(mediaLink){
  var player = new MediaElementPlayer('stream-media', {
    features: ['playpause','progress','current','duration','volume','fullscreen'], // default controls can be hidden or customized
    success: function(mediaElement, originalNode, instance){
      mediaElement.setSrc(mediaLink);
      mediaElement.load();

      var container = instance.container;

      // --- Custom Top Buttons ---
      function createButton(iconClass, top, left, onClick){
        var btn = document.createElement('div');
        btn.className = 'custom-button';
        btn.style.top = top+'px';
        btn.style.left = left+'px';
        btn.innerHTML = '<i class="'+iconClass+'"></i>';
        btn.onclick = onClick;
        container.appendChild(btn);
        return btn;
      }

      // Play/Pause top
      var playBtn = createButton('fas fa-play', 10, 10, function(){
        if(mediaElement.paused){ mediaElement.play(); playBtn.innerHTML='<i class="fas fa-pause"></i>'; }
        else { mediaElement.pause(); playBtn.innerHTML='<i class="fas fa-play"></i>'; }
      });

      // Volume top
      var volumeBtn = createButton('fas fa-volume-up', 60, 10, function(){
        if(mediaElement.muted){ mediaElement.muted=false; volumeBtn.innerHTML='<i class="fas fa-volume-up"></i>'; }
        else { mediaElement.muted=true; volumeBtn.innerHTML='<i class="fas fa-volume-mute"></i>'; }
      });

      // Fullscreen top
      var fullscreenBtn = createButton('fas fa-expand', 110, 10, function(){
        if(!document.fullscreenElement){ container.requestFullscreen(); fullscreenBtn.innerHTML='<i class="fas fa-compress"></i>'; }
        else { document.exitFullscreen(); fullscreenBtn.innerHTML='<i class="fas fa-expand"></i>'; }
      });

      // Download top
      createButton('fas fa-download', 160, 10, function(){
        var a = document.createElement('a'); a.href=mediaLink; a.download=''; document.body.appendChild(a); a.click(); document.body.removeChild(a);
      });

      // Share top
      createButton('fas fa-share', 210, 10, function(){
        if(navigator.share){ navigator.share({ title:"Play", url: mediaLink }); }
      });

      // Watermark
      var watermark = document.createElement('img');
      watermark.src = 'https://chadstreamz.sbs/assets/images/log2.png';
      watermark.className = 'mejs-watermark';
      container.appendChild(watermark);

      // --- Update top play button when bottom controls change ---
      mediaElement.addEventListener('play', function(){ playBtn.innerHTML='<i class="fas fa-pause"></i>'; });
      mediaElement.addEventListener('pause', function(){ playBtn.innerHTML='<i class="fas fa-play"></i>'; });
    }
  });
}else{
  document.getElementById('error-message').textContent = 'Error: Media URL not provided';
}
</script>

</body>
</html>
