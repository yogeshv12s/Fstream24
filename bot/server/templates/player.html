<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Responsive MediaElement Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/5.0.5/mediaelementplayer.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/mediaelement/5.0.5/mediaelement-and-player.min.js"></script>

<style>
html, body { margin:0; height:100%; background:black; }

#stream-media { width:100%; height:100%; background:black; display:block; }

/* Watermark */
.mejs-watermark {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 80px;
  opacity: 0.6;
  z-index: 1000;
  pointer-events: none;
}

/* Top Custom Buttons */
.custom-button {
  position: absolute;
  border-radius: 50%;
  text-align: center;
  color: white;
  background-color: rgba(0,0,0,0.7);
  z-index: 1000;
  cursor: pointer;
  font-family: "Font Awesome 5 Free";
  font-weight: 900;
  transition: 0.3s;
}
.custom-button:hover { background-color: rgba(255,255,255,0.7); color:black; }

/* Bottom Control Bar */
#control-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  padding: 5px 10px;
  z-index: 1000;
  flex-wrap: wrap;
}
#control-bar i { color: white; cursor: pointer; margin-right: 10px; }
#progress-container {
  flex: 1;
  height: 6px;
  background: rgba(255,255,255,0.3);
  border-radius: 3px;
  cursor: pointer;
  margin: 0 10px;
  position: relative;
}
#progress { height: 6px; background: #ff0000; width: 0%; border-radius: 3px; }
#time-display { color:white; font-size:14px; white-space: nowrap; }

/* Responsive Sizes */
@media(max-width:768px){
  .mejs-watermark { width: 60px; }
  .custom-button { width: 35px; height: 35px; line-height:35px; font-size:16px; }
  #control-bar i { font-size:16px; margin-right:5px; }
  #progress-container { height:4px; }
  #progress { height:4px; }
}
@media(min-width:1200px){
  .mejs-watermark { width: 100px; }
  .custom-button { width: 50px; height: 50px; line-height:50px; font-size:22px; }
  #control-bar i { font-size:22px; margin-right:10px; }
  #progress-container { height:8px; }
  #progress { height:8px; }
}
</style>
</head>
<body>

<video id="stream-media" preload="auto"></video>
<div id="error-message"></div>

<script>
var mediaLink = "{{ mediaLink }}"; // Replace with your media URL

if(mediaLink){
  var player = new MediaElementPlayer('stream-media', {
    features: [], // We'll handle custom controls
    success: function(mediaElement, originalNode, instance){
      mediaElement.setSrc(mediaLink);
      mediaElement.load();
      var container = instance.container;

      // --- Create Top Buttons ---
      function createButton(iconClass, top, left, size, onClick){
        var btn = document.createElement('div');
        btn.className = 'custom-button';
        btn.style.top = top+'px';
        btn.style.left = left+'px';
        btn.style.width = size+'px';
        btn.style.height = size+'px';
        btn.style.lineHeight = size+'px';
        btn.innerHTML = '<i class="'+iconClass+'"></i>';
        btn.onclick = onClick;
        container.appendChild(btn);
        return btn;
      }

      // Dynamic size based on screen width
      var btnSize = window.innerWidth <=768 ? 35 : (window.innerWidth>=1200?50:40);

      var playBtn = createButton('fas fa-play',10,10,btnSize,function(){
        if(mediaElement.paused){ mediaElement.play(); playBtn.innerHTML='<i class="fas fa-pause"></i>'; }
        else { mediaElement.pause(); playBtn.innerHTML='<i class="fas fa-play"></i>'; }
      });

      var volumeBtn = createButton('fas fa-volume-up',60,10,btnSize,function(){
        if(mediaElement.muted){ mediaElement.muted=false; volumeBtn.innerHTML='<i class="fas fa-volume-up"></i>'; }
        else { mediaElement.muted=true; volumeBtn.innerHTML='<i class="fas fa-volume-mute"></i>'; }
      });

      var fullscreenBtn = createButton('fas fa-expand',110,10,btnSize,function(){
        if(!document.fullscreenElement){ container.requestFullscreen(); fullscreenBtn.innerHTML='<i class="fas fa-compress"></i>'; }
        else { document.exitFullscreen(); fullscreenBtn.innerHTML='<i class="fas fa-expand"></i>'; }
      });

      createButton('fas fa-download',160,10,btnSize,function(){
        var a = document.createElement('a'); a.href=mediaLink; a.download=''; document.body.appendChild(a); a.click(); document.body.removeChild(a);
      });

      createButton('fas fa-share',210,10,btnSize,function(){
        if(navigator.share){ navigator.share({ title:"Play", url: mediaLink }); }
      });

      // Watermark
      var watermark = document.createElement('img');
      watermark.src = 'https://chadstreamz.sbs/assets/images/log2.png';
      watermark.className = 'mejs-watermark';
      container.appendChild(watermark);

      // --- Bottom Control Bar ---
      var controlBar = document.createElement('div'); controlBar.id='control-bar';
      container.appendChild(controlBar);

      // Play/Pause Bottom
      var bottomPlay = document.createElement('i'); bottomPlay.className='fas fa-play'; controlBar.appendChild(bottomPlay);
      bottomPlay.onclick = function(){
        if(mediaElement.paused){ mediaElement.play(); bottomPlay.className='fas fa-pause'; playBtn.innerHTML='<i class="fas fa-pause"></i>'; }
        else { mediaElement.pause(); bottomPlay.className='fas fa-play'; playBtn.innerHTML='<i class="fas fa-play"></i>'; }
      };

      // Progress Bar
      var progressContainer = document.createElement('div'); progressContainer.id='progress-container';
      var progress = document.createElement('div'); progress.id='progress'; progressContainer.appendChild(progress);
      controlBar.appendChild(progressContainer);

      function updateProgress(e){
        var rect = progressContainer.getBoundingClientRect();
        var pos = Math.min(Math.max(0, e.clientX - rect.left), rect.width)/rect.width;
        mediaElement.currentTime = pos*mediaElement.duration;
      }

      progressContainer.addEventListener('click', updateProgress);
      progressContainer.addEventListener('mousedown', function(){
        function moveHandler(e){ updateProgress(e); }
        function upHandler(){ document.removeEventListener('mousemove', moveHandler); document.removeEventListener('mouseup', upHandler); }
        document.addEventListener('mousemove', moveHandler);
        document.addEventListener('mouseup', upHandler);
      });

      // Time Display
      var timeDisplay = document.createElement('span'); timeDisplay.id='time-display'; timeDisplay.textContent='00:00 / 00:00';
      controlBar.appendChild(timeDisplay);

      mediaElement.addEventListener('timeupdate', function(){
        var percent = (mediaElement.currentTime/mediaElement.duration)*100;
        progress.style.width = percent+'%';
        function formatTime(t){ var m=Math.floor(t/60).toString().padStart(2,'0'); var s=Math.floor(t%60).toString().padStart(2,'0'); return m+':'+s; }
        timeDisplay.textContent = formatTime(mediaElement.currentTime)+' / '+formatTime(mediaElement.duration);
      });

      // Sync top play button with bottom
      mediaElement.addEventListener('play', function(){ playBtn.innerHTML='<i class="fas fa-pause"></i>'; bottomPlay.className='fas fa-pause'; });
      mediaElement.addEventListener('pause', function(){ playBtn.innerHTML='<i class="fas fa-play"></i>'; bottomPlay.className='fas fa-play'; });
    }
  });
}else{
  document.getElementById('error-message').textContent = 'Error: Media URL not provided';
}
</script>

</body>
</html>
